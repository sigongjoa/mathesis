# Node 0: Student Hub - Product Requirements Document (PRD)

**문서 버전**: 1.0
**작성일**: 2026-01-09
**작성자**: Mathesis Platform Team
**승인자**: Product Owner
**상태**: Draft

---

## 📋 목차

1. [개요](#1-개요)
2. [비즈니스 목표](#2-비즈니스-목표)
3. [사용자 페르소나](#3-사용자-페르소나)
4. [기능 요구사항](#4-기능-요구사항)
5. [비기능 요구사항](#5-비기능-요구사항)
6. [사용자 스토리](#6-사용자-스토리)
7. [성공 지표](#7-성공-지표)
8. [제약사항 및 가정](#8-제약사항-및-가정)
9. [로드맵](#9-로드맵)

---

## 1. 개요

### 1.1 제품 비전

**Student Hub (Node 0)**는 Mathesis 플랫폼의 중추 신경계로서, 모든 학생 데이터를 통합 관리하고 개인화된 교육 경험을 자동화하는 마스터 노드입니다.

### 1.2 문제 정의

**현재 문제**:
- 학생 데이터가 여러 노드(Node 1-6)에 분산되어 있어 통합 뷰 제공 불가
- 수동으로 학습 경로를 설계해야 하므로 개인화 한계
- 학생의 학습 위기 상황을 실시간 감지 및 개입 불가
- 교사가 학급 전체 현황을 파악하기 어려움

**해결 방안**:
- 학생 마스터 데이터의 단일 진실 공급원 (Single Source of Truth)
- AI 기반 자동 학습 경로 생성 및 개입 시스템
- 실시간 통합 프로필 제공
- 학급/학교 단위 분석 대시보드

### 1.3 제품 범위

**포함 (In Scope)**:
- ✅ 학생 마스터 데이터 CRUD
- ✅ 통합 학생 프로필 (모든 노드 데이터 집계)
- ✅ 학습 경로 생성 및 관리
- ✅ 자동 개입 시스템 (규칙 기반)
- ✅ 주기적 작업 스케줄링 (리포트, 학습 계획)
- ✅ 학급/학교 분석 및 대시보드

**제외 (Out of Scope)**:
- ❌ 문제 생성 (Node 3 담당)
- ❌ 학습 콘텐츠 제작
- ❌ 결제 및 구독 관리
- ❌ 실시간 화상 수업 기능

---

## 2. 비즈니스 목표

### 2.1 핵심 목표

1. **학생 데이터 통합**: 분산된 학생 데이터를 하나의 프로필로 통합
2. **학습 경험 자동화**: 수동 작업을 90% 감소
3. **조기 개입**: 학습 위기 학생 90% 이상 조기 발견
4. **교사 생산성 향상**: 학급 관리 시간 50% 감소

### 2.2 비즈니스 KPI

| KPI | 목표 | 측정 방법 |
|-----|------|----------|
| **통합 프로필 조회 속도** | < 2초 | API 응답 시간 측정 |
| **자동 개입 정확도** | > 85% | 교사 피드백 기반 |
| **학습 경로 완료율** | > 70% | 학생별 목표 달성률 |
| **교사 만족도** | > 4.5/5.0 | 분기별 설문조사 |

---

## 3. 사용자 페르소나

### 3.1 페르소나: 학생 (김철수, 14세, 중2)

**배경**:
- 수학을 좋아하지만 최근 성적이 떨어짐
- 스마트폰으로 학습 앱 사용에 익숙
- 즉각적인 피드백을 원함

**니즈**:
- 내 실력에 맞는 문제를 추천받고 싶음
- 왜 틀렸는지 자세한 설명이 필요함
- 진도가 얼마나 됐는지 시각적으로 보고 싶음

**페인 포인트**:
- 너무 어려운 문제만 나오면 포기하게 됨
- 어디서부터 다시 공부해야 할지 모름
- 부모님이 자꾸 공부하라고 잔소리함

**Student Hub가 해결하는 방법**:
- ✅ 적응형 학습 경로로 적절한 난이도 유지
- ✅ 개념 갭 분석으로 정확한 복습 포인트 제시
- ✅ 자동 진도 알림으로 부모와 소통 개선

### 3.2 페르소나: 교사 (이선생, 35세, 수학 교사)

**배경**:
- 3개 학급 (90명) 담당
- 학생별 맞춤 지도를 하고 싶지만 시간 부족
- 데이터 기반 수업 설계에 관심 많음

**니즈**:
- 학급 전체 현황을 한눈에 파악
- 위기 학생을 조기 발견하고 싶음
- 반복 작업(리포트 작성, 학부모 상담 자료) 자동화

**페인 포인트**:
- 학생 90명을 일일이 관리하기 어려움
- 리포트 작성에 주말을 다 써야 함
- 학습 부진 학생을 늦게 발견하게 됨

**Student Hub가 해결하는 방법**:
- ✅ 학급 대시보드로 전체 현황 실시간 파악
- ✅ 자동 개입 시스템이 위기 학생 알림
- ✅ 주간/월간 리포트 자동 생성

### 3.3 페르소나: 학부모 (김엄마, 42세, 직장인)

**배경**:
- 회사 일로 바쁨
- 자녀 교육에 관심 많지만 직접 관리 어려움
- 학원 말고 다른 방법을 찾고 있음

**니즈**:
- 아이가 잘 공부하고 있는지 확인
- 어떤 부분이 부족한지 알고 싶음
- 선생님과 원활한 소통

**페인 포인트**:
- 아이에게 물어봐도 "잘 모르겠어요"
- 학원 숙제만 쫓아가느라 학교 진도 놓침
- 선생님께 연락하기 부담스러움

**Student Hub가 해결하는 방법**:
- ✅ 주간 리포트로 자녀 학습 현황 이메일 수신
- ✅ 취약 개념 자동 진단 및 추천
- ✅ 자동 알림으로 학부모-교사 소통 개선

---

## 4. 기능 요구사항

### 4.1 학생 관리 (Priority: P0 - Must Have)

#### FR-1.1: 학생 등록
- **요구사항**: 교사가 새로운 학생을 시스템에 등록할 수 있어야 함
- **입력**: 이름, 학년, 학교, 학부모 연락처
- **출력**: 학생 ID 생성, 초기 프로필 생성
- **검증**: 중복 학생 체크 (이름 + 생년월일)

#### FR-1.2: 학생 정보 수정
- **요구사항**: 학생 기본 정보를 수정할 수 있어야 함
- **권한**: 교사, 관리자
- **제약**: 학생 ID는 변경 불가

#### FR-1.3: 학생 삭제 (Soft Delete)
- **요구사항**: 학생을 비활성화(졸업, 전학)할 수 있어야 함
- **동작**: 상태를 'inactive'로 변경, 데이터는 보존
- **복구**: 관리자가 재활성화 가능

### 4.2 통합 프로필 (Priority: P0 - Must Have)

#### FR-2.1: 360도 학생 뷰
- **요구사항**: 모든 노드의 데이터를 하나의 프로필로 집계
- **데이터 소스**:
  - Node 1: 개념 갭 정보
  - Node 2: BKT/IRT 숙련도
  - Node 4: 학습 활동 히트맵
  - Node 5: 리포트 히스토리
- **응답 시간**: < 2초
- **캐싱**: Redis 5분 TTL

#### FR-2.2: 프로필 섹션 선택 조회
- **요구사항**: 필요한 섹션만 선택적으로 조회 가능
- **옵션**: basic, mastery, activities, reports, learning_path
- **이유**: 성능 최적화

### 4.3 학습 경로 (Priority: P0 - Must Have)

#### FR-3.1: 자동 학습 경로 생성
- **요구사항**: 학생의 현재 상태를 분석하여 맞춤형 학습 경로 자동 생성
- **입력**: 학생 ID, 목표 개념
- **프로세스**:
  1. Node 1에서 개념 갭 분석
  2. 선수 지식 트리 구성
  3. 위상 정렬로 학습 순서 결정
  4. Node 3에 문제 생성 요청
- **출력**: 학습 경로 ID, 단계별 목표, 예상 완료일

#### FR-3.2: 학습 진도 추적
- **요구사항**: 학생의 학습 경로 진행률을 실시간 업데이트
- **트리거**: 문제 풀이 완료, 개념 복습 완료
- **업데이트**: 진행률 (%), 다음 마일스톤

#### FR-3.3: 학습 경로 수정
- **요구사항**: 교사가 자동 생성된 경로를 수정 가능
- **수정 항목**: 목표 개념 추가/제거, 순서 변경
- **제약**: 선수 관계 위반 시 경고

### 4.4 자동 개입 (Priority: P1 - Should Have)

#### FR-4.1: 개입 규칙 정의
- **요구사항**: 조건 기반 자동 개입 규칙을 정의할 수 있어야 함
- **규칙 예시**:
  - "3회 연속 오답" → 개념 복습 영상 발송
  - "7일간 활동 없음" → 격려 이메일
  - "숙련도 0.3 이상 하락" → 교사에게 알림

#### FR-4.2: 개입 실행
- **요구사항**: 규칙 조건 충족 시 자동으로 액션 실행
- **액션 유형**:
  - 문제 생성 (Node 3 호출)
  - 영상 추천
  - 이메일/SMS 발송
  - 교사 알림
- **로그**: 모든 개입 기록 저장

#### FR-4.3: 개입 효과 분석
- **요구사항**: 개입 전후 학생 성과를 비교 분석
- **지표**: 숙련도 변화, 활동 증가율
- **리포트**: 월간 개입 효과 리포트 생성

### 4.5 스케줄링 (Priority: P1 - Should Have)

#### FR-5.1: 주기적 작업 등록
- **요구사항**: Cron 표현식으로 주기적 작업 스케줄링
- **작업 유형**:
  - 주간 리포트 생성
  - 월간 리포트 생성
  - 학습 경로 갱신
  - 개입 규칙 체크
- **Cron 예시**: `0 9 * * MON` (매주 월요일 9시)

#### FR-5.2: 스케줄 관리
- **요구사항**: 스케줄 활성화/비활성화, 수정, 삭제
- **알림**: 다음 실행 시간 표시
- **로그**: 실행 이력 저장

### 4.6 분석 & 대시보드 (Priority: P2 - Nice to Have)

#### FR-6.1: 학급 통계
- **요구사항**: 학급 단위 통계 제공
- **지표**:
  - 평균 숙련도
  - 완료율
  - 상위/하위 10% 학생
  - 공통 취약 개념
- **시각화**: 차트 이미지 제공

#### FR-6.2: 학교 대시보드
- **요구사항**: 학교 전체 현황 한눈에 파악
- **데이터**: 학년별 통계, 교사별 학급 현황
- **권한**: 교장, 부장교사

---

## 5. 비기능 요구사항

### 5.1 성능 (Performance)

| 요구사항 | 목표 | 측정 방법 |
|----------|------|----------|
| **API 응답 시간** | 95% 요청 < 2초 | Prometheus 모니터링 |
| **통합 프로필 조회** | < 2초 (캐시 히트), < 5초 (캐시 미스) | APM 추적 |
| **동시 사용자** | 1,000명 | 부하 테스트 (Locust) |
| **데이터베이스 쿼리** | < 100ms (95 percentile) | PostgreSQL slow query log |

### 5.2 확장성 (Scalability)

- **수평 확장**: FastAPI 서버 다중 인스턴스 배포 가능
- **데이터베이스**: PostgreSQL Read Replica 지원
- **캐시**: Redis Cluster 지원
- **목표**: 학생 100만명, 교사 1만명 지원

### 5.3 가용성 (Availability)

- **SLA**: 99.5% uptime (월 3.6시간 다운타임 허용)
- **장애 복구**: < 15분 (MTTR - Mean Time To Recovery)
- **백업**: 일일 자동 백업, 7일간 보관
- **Health Check**: 30초마다 /health 엔드포인트 체크

### 5.4 보안 (Security)

- **인증**: JWT 기반 토큰 인증
- **권한**: 역할 기반 접근 제어 (RBAC)
  - 학생: 본인 데이터만 조회
  - 교사: 담당 학생 조회/수정
  - 관리자: 전체 접근
- **개인정보 보호**: 학생 이름 마스킹 (통계 조회 시)
- **데이터 암호화**: 민감 정보 (학부모 연락처) AES-256 암호화

### 5.5 유지보수성 (Maintainability)

- **코드 커버리지**: > 80%
- **문서화**: 모든 API OpenAPI 3.0 명세 작성
- **로깅**: 구조화된 JSON 로그 (ELK Stack 연동)
- **모니터링**: Prometheus + Grafana 대시보드

---

## 6. 사용자 스토리

### Epic 1: 학생 온보딩

#### US-1.1: 신규 학생 등록
```
As a 교사
I want to 새로운 학생을 시스템에 등록하고 싶다
So that 학생의 학습 데이터를 추적할 수 있다

Acceptance Criteria:
- [ ] 학생 이름, 학년, 학교 입력 후 저장
- [ ] 중복 체크 (동일 이름 + 생년월일)
- [ ] 자동으로 다른 노드에 초기 데이터 생성 (BKT, 히트맵)
- [ ] 학부모에게 환영 이메일 자동 발송
```

#### US-1.2: 초기 진단 테스트
```
As a 학생
I want to 초기 진단 테스트를 받고 싶다
So that 내 실력에 맞는 학습 계획을 받을 수 있다

Acceptance Criteria:
- [ ] 회원가입 후 진단 테스트 링크 수신
- [ ] 10-15문제, 15분 소요
- [ ] 테스트 완료 후 자동으로 학습 경로 생성
- [ ] 결과 리포트 이메일 수신
```

### Epic 2: 학습 경로 관리

#### US-2.1: 맞춤형 학습 경로 생성
```
As a 시스템
I want to 학생의 진단 결과를 바탕으로 학습 경로를 자동 생성하고 싶다
So that 개인화된 학습 경험을 제공할 수 있다

Acceptance Criteria:
- [ ] 개념 갭 분석 (Node 1)
- [ ] 선수 지식 트리 구성
- [ ] 목표 개념까지의 최단 경로 계산
- [ ] 각 단계별 문제 5개 자동 생성 (Node 3)
- [ ] 예상 완료 기간 계산
```

#### US-2.2: 학습 진도 추적
```
As a 학생
I want to 내 학습 진도를 시각적으로 보고 싶다
So that 동기부여를 받을 수 있다

Acceptance Criteria:
- [ ] 진행률 바 (0-100%)
- [ ] 완료한 개념 체크 표시
- [ ] 다음 마일스톤까지 남은 문제 수
- [ ] 예상 완료일 표시
```

### Epic 3: 자동 개입

#### US-3.1: 학습 위기 감지
```
As a 시스템
I want to 학생의 학습 위기 상황을 조기 감지하고 싶다
So that 적절한 개입을 할 수 있다

Acceptance Criteria:
- [ ] 매시간 모든 활성 학생 체크
- [ ] 3회 연속 오답 감지
- [ ] 7일간 활동 없음 감지
- [ ] 숙련도 급락 (0.3 이상 하락) 감지
```

#### US-3.2: 자동 개념 복습 제공
```
As a 학생
I want to 계속 틀리는 개념을 자동으로 복습하고 싶다
So that 약점을 극복할 수 있다

Acceptance Criteria:
- [ ] 3회 연속 오답 시 알림 수신
- [ ] 해당 개념 영상 링크 제공
- [ ] 쉬운 문제 5개 자동 생성
- [ ] 복습 완료 후 원래 진도로 복귀
```

### Epic 4: 주기적 리포트

#### US-4.1: 주간 학습 리포트
```
As a 학부모
I want to 매주 자녀의 학습 현황을 이메일로 받고 싶다
So that 공부를 잘 하고 있는지 확인할 수 있다

Acceptance Criteria:
- [ ] 매주 월요일 오전 9시 발송
- [ ] PDF 리포트 첨부
- [ ] 지난주 학습 시간, 문제 풀이 수
- [ ] 숙련도 변화 그래프
- [ ] 취약 개념 top 3
```

---

## 7. 성공 지표

### 7.1 제품 지표

| 지표 | 현재 | 목표 (3개월) | 목표 (6개월) |
|------|------|-------------|-------------|
| **활성 학생 수** | 0 | 1,000명 | 5,000명 |
| **일일 활성 사용자 (DAU)** | 0 | 300명 | 1,500명 |
| **학습 경로 완료율** | N/A | 60% | 70% |
| **자동 개입 정확도** | N/A | 80% | 85% |

### 7.2 사용성 지표

| 지표 | 목표 |
|------|------|
| **교사 만족도** | > 4.5/5.0 |
| **학부모 만족도** | > 4.0/5.0 |
| **학생 NPS** | > 40 |
| **일주일 유지율** | > 70% |

### 7.3 기술 지표

| 지표 | 목표 |
|------|------|
| **API 가용성** | 99.5% |
| **평균 응답 시간** | < 500ms |
| **에러율** | < 0.1% |
| **캐시 히트율** | > 80% |

---

## 8. 제약사항 및 가정

### 8.1 제약사항

**기술적 제약**:
- Python 3.11+ 사용 (레거시 코드 호환성)
- PostgreSQL 14+ 필수 (JSONB, ltree 기능 사용)
- 온프레미스 배포 우선 (클라우드는 Phase 3)

**비즈니스 제약**:
- 개발 기간: 3개월 (MVP)
- 개발 인력: Backend 2명, Frontend 1명, QA 1명
- 예산: 인건비 외 추가 비용 최소화 (오픈소스 우선)

**법적 제약**:
- 개인정보보호법 준수 (학생 데이터 암호화)
- 교육 관련 법규 준수

### 8.2 가정

1. **Node 1-6이 정상 작동**: Student Hub는 다른 노드들이 정상 동작한다고 가정
2. **네트워크 안정성**: 학교 네트워크가 안정적이라고 가정
3. **교사 협조**: 교사들이 시스템 사용에 적극적이라고 가정
4. **학생 디바이스**: 학생들이 스마트폰 또는 PC를 보유하고 있다고 가정

---

## 9. 로드맵

### Phase 1: MVP (Month 1-3)

**목표**: 핵심 기능으로 최소 동작 제품 완성

- [x] Week 1-2: 학생 CRUD API
- [x] Week 3-4: MCP Client Manager (Node 1-6 호출)
- [x] Week 5-6: 통합 프로필 조회
- [x] Week 7-8: 학습 경로 생성
- [x] Week 9-10: 자동 개입 시스템 (기본 규칙)
- [x] Week 11-12: 테스트 및 버그 수정

### Phase 2: 고도화 (Month 4-6)

**목표**: 분석 및 스케줄링 기능 추가

- [ ] Week 13-14: Celery 스케줄링
- [ ] Week 15-16: 주간/월간 리포트 자동 생성
- [ ] Week 17-18: 학급 분석 대시보드
- [ ] Week 19-20: 개입 효과 분석
- [ ] Week 21-22: 성능 최적화
- [ ] Week 23-24: 사용자 피드백 반영

### Phase 3: 엔터프라이즈 (Month 7-9)

**목표**: 대규모 학교 지원

- [ ] Week 25-26: 학교 대시보드
- [ ] Week 27-28: 멀티테넌시 (학교별 독립 DB)
- [ ] Week 29-30: 실시간 알림 (WebSocket)
- [ ] Week 31-32: 모바일 앱 API
- [ ] Week 33-34: AI 코칭 챗봇 통합
- [ ] Week 35-36: 운영 최적화

---

## 10. 부록

### 10.1 용어 정의

| 용어 | 정의 |
|------|------|
| **마스터 데이터** | 학생의 핵심 정보 (이름, 학년, 학교 등) |
| **통합 프로필** | 모든 노드의 데이터를 집계한 360도 학생 뷰 |
| **학습 경로** | 목표 달성을 위한 단계별 학습 계획 |
| **개입** | 학습 위기 상황에 자동으로 실행되는 액션 |
| **개념 갭** | 목표 개념과 현재 숙련도의 차이 |

### 10.2 참고 문서

- [TDD (Technical Design Document)](./TDD.md)
- [SDD (Software Design Document)](./SDD.md)
- [API Specification](./API.md)
- [Database Schema](./DATABASE.md)

---

**문서 변경 이력**:

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-09 | Platform Team | 초안 작성 |

**승인**:
- [ ] Product Owner
- [ ] Tech Lead
- [ ] QA Lead
